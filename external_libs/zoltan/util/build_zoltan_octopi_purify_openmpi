# Script for building Zoltan with purify on octopi with openmpi.
# PLEASE CHANGE THE PREFIX TO POINT TO YOUR OWN DIRECTORY!  THANKS!
# This is a 64-bit installation.

set path=(/usr/local/bin $path)
setenv PURE_CC "purify -best-effort -follow-child-processes=yes -cache-dir=/tmp/purify -chain-length=20"
setenv CC  "$PURE_CC gcc34  -Wall -Werror-implicit-function-declaration"
setenv CXX "$PURE_CC g++34  -Wall -Werror-implicit-function-declaration"
setenv F77 /usr/local/bin/mpif77
setenv CFLAGS "-m64 -g"
setenv CXXFLAGS "-m64 -g"
setenv CPPFLAGS "-m64 -g"
setenv FFLAGS "-m64 -g"
setenv MPIINC `mpicc --showme:compile`
setenv MPILIB `mpicc --showme:link`
#setenv LDFLAGS -m64

../configure -C \
  --prefix=/Net/local/homes/kddevin/code/trilinos_v9.0/Obj_linux64 \
  --enable-mpi  \
  --disable-default-packages \
  --with-gnumake \
  --enable-zoltan \
  --disable-zoltan-cppdriver \
  --with-incdirs="-I/Net/local/proj/zoltan/arch/all/src/ParMETIS3 -I/Net/local/proj/zoltan/arch/all/src/ParMETIS3/METISLib $MPIINC" \
  --with-libs="-L/Net/local/proj/zoltan/arch/linux64/lib/openmpi/ParMETIS3_1 -lparmetis -lmetis -L/Net/local/proj/zoltan/arch/linux64/PaToH -lpatoh $MPILIB" \
   |& tee KDD.C
make everything |& tee KDD.M
make install |& tee KDD.I
