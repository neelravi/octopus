# -*- coding: utf-8 -*-
#
# $Id$
#
# This input file propagates a 2D Gaussian wavepacket through
# transparent boundaries in x- and against rigid ones in y-direction.
# The kinetic energy is calculated by a third order discretization.
# The Q matrices are fully calculated.

DebugLevel = 0

CalculationMode = td_transport

TheoryLevel = independent_particles

BoxShape = parallelepiped

DerivativesOrder = 3

TDTimeStep = 0.075
TDMaximumIter = 75
TDEvolutionMethod = crank_nicholson_src_mem

TDTransAdditionalTerms = mem_term
TDTransMemType = save_cpu_time

Dimensions = 2
Spacing = 0.25
%Lsize
  4 | 4 | 0
%

OnlyUserDefinedInitialStates = yes
ExtraStates = 1

kx = 1.75
ky = 1.0
alpha = 0.5
i = {0, 1}

%UserDefinedStates
 1 | 1 | 1 | formula | "exp(i*(kx*x + ky*y))*exp(-alpha*r*r)"
%

%Occupations
 1.0
%

FromScratch = yes

OutputEvery = 2

Output = wfs_sqmod + wfs

OutputHow = gnuplot + plane_z
