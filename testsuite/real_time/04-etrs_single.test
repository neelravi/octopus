# -*- coding: utf-8 mode: shell-script -*-
# $Id: 24-cpmd.test 3344 2007-10-13 13:38:03Z acastro $

Test       : Enforced time reversal symmetry propagator - single precision
Author     : Xavier
Release    : 3.1.0pre1
Programs   : octopus_single
TestGroups : short-run
Enabled    : Yes

# This test checks the time propagation for the single precision
# version of octopus, input files are the same from 01-etrs
# test. Convergence criteria are less strict.

# ground state
Processors : 1
Input      : 01-etrs.01-gs.inp
Match ; Initial Energy   ; sed -n '/^Energy/{n\;p\;}' static/info ; \s*Total\s*=\s*-11.00

Processors : 4
Input      : 01-etrs.02-td.inp
Match ; Energy [step 1]  ; tail -21 td.general/energy | head -1 ; \s*-1.098
Match ; Energy [step 5]  ; tail -16 td.general/energy | head -1 ; \s*-1.098
Match ; Energy [step 10] ; tail -11 td.general/energy | head -1 ; \s*-1.098
Match ; Energy [step 15] ; tail -6 td.general/energy  | head -1 ; \s*-1.098
Match ; Energy [step 20] ; tail -1 td.general/energy  | head -1 ; \s*-1.098

Match ; Forces [step 1]  ; echo $(tail -21 td.general/coordinates | head -1 | cut -b 270-288) -0.1698 | sed 's/e/\*10^/g' | bc -l ; \.000
Match ; Forces [step 5]  ; echo $(tail -16 td.general/coordinates | head -1 | cut -b 270-288) -0.1672 | sed 's/e/\*10^/g' | bc -l ; \.000
Match ; Forces [step 10] ; echo $(tail -11 td.general/coordinates | head -1 | cut -b 270-288) -0.1670 | sed 's/e/\*10^/g' | bc -l ; \.000
Match ; Forces [step 15] ; echo $(tail -6  td.general/coordinates | head -1 | cut -b 270-288) -0.1673 | sed 's/e/\*10^/g' | bc -l ; \.000
Match ; Forces [step 20] ; echo $(tail -1  td.general/coordinates | head -1 | cut -b 270-288) -0.1675 | sed 's/e/\*10^/g' | bc -l ; \.000
