# -*- coding: utf-8 mode: shell-script -*-
# $Id$
Test       : Carbon
Author     : Alberto
Date       : 02.03.06
Arch       : Linux g38 2.6.14-desktop-2 #1 SMP PREEMPT Sun Nov 20 20:45:48 CET 2005 i686 GNU/Linux
Release    : 2.2.0pre1
Programs   : octopus
TestGroups : long-run
Enabled    : Yes

# The purpose of this test is making sure that spin-polarized
# calculations work.
# It is the calculation of one atom of Carbon, within the LSDA
# calculation.
#
# The result *almost* compares (to within 0.1eV) with the results
# given at the NIST webpage:
# http://physics.nist.gov/PhysRefData/DFTdata/contents.html
# The reasons for the discrepancy may be two:
# o The NIST calculation is all-electron.
# o The NIST calculation uses the VWN correlation. Here I have put
#   put PZ, because otherwise the results are even worse (probably
#   our VWN has some bug?)
# It would be nice to investigate the reason for the small
# discrepancy...

Input: 01-carbon_atom.01-ground_state.inp

Match ; Total Energy       ; grep -A 7 '^Energy:' static/info ; \s*Total\s*=\s*-146.743
Match ; Eigenvalue   [1up] ; grep -A 2 'Eigenvalues \[' static/info | tail -1 ; \s*-14.462\d*\s*1.0000\d*
Match ; Eigenvalue [4down] ; grep -A 9 'Eigenvalues \[' static/info | tail -1 ; \s*-3.682\d*\s*0.000000\d*

# Now we repeat the calculation but making use of the l=1 component
# of the pseudopotencial to build the local component.

Input: 01-carbon_atom.02-ground_state.inp

Match ; Total Energy       ; grep -A 7 '^Energy:' static/info ; \s*Total\s*=\s*-146.813
Match ; Eigenvalue   [1up] ; grep -A 2 'Eigenvalues \[' static/info | tail -1 ; \s*-14.466\d*\s*1.0000\d*
Match ; Eigenvalue [4down] ; grep -A 9 'Eigenvalues \[' static/info | tail -1 ; \s*-3.683\d*\s*0.000000\d*

#The same using double grid
Input: 01-carbon_atom.03-ground_state_double_grid.inp

Match ; Total Energy       ; grep -A 7 '^Energy:' static/info ; \s*Total\s*=\s*-146.663
Match ; Eigenvalue   [1up] ; grep -A 2 'Eigenvalues \[' static/info | tail -1 ; \s*-14.418\d*\s*1.0000\d*
Match ; Eigenvalue [4down] ; grep -A 9 'Eigenvalues \[' static/info | tail -1 ; \s*-3.694\d*\s*0.000000\d*
