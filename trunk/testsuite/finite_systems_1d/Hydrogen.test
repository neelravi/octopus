# $Id: oct-run_regression_test.pl,v 1.11 2005/12/07 22:26:41 appel Exp      :

Test     : 1D-Hydrogen
Author   : Alberto
Date     : 19.02.06
Arch     : Linux rhodas 2.6.8-2-386 #1 Tue Aug 16 12:46:35 UTC 2005 i686 GNU/Linux
Release  : 2.0.1devel
Programs : octopus; octopus_cmplx
Enabled  : Yes

# This test calculates a one-dimensional model for Hydrogen, considering
# a soft-Coulomb nuclueus-electron interaction. It calculates the ground-state
# in a first run, and then the first nine excited states in the "unocc" mode.
# It is about the simplest thing one can do with octopus...
#
# It is a replication of the calculation presented in Table I of
# [J. Javanainen, J. H. Eberly and Q. Su, Phys. Rev. A 38, 3430 (1998)].
# The numbers provided in that Table should match the values that octopus
# prints in the excited_states_static/eigenvalues file.

INP
%CalculationMode
gs              | unocc
"ground_state_" | "excited_states_"
1               | 2
%

Dimensions = 1
fromScratch = yes

BoxShape = sphere
Spacing = 0.5
Radius = 100.0

NonInteractingElectrons = yes

%Species
"Hydrogen1D" | 1 | 1 | 1 | "-1/sqrt(1+(x)^2)"
%

%Coordinates
"Hydrogen1D" | 0 | 0 | 0
%

EigenSolverInitTolerance = 1.0e-6
EigenSolverFinalTolerance = 1.0e-6
EigenSolverMaxIter = 1000
Mixing = 1.0
TypeOfMixing = linear

NumberUnoccStates = 9
EOF

RUN

Match ; TotalEnergy ; grep -A 6 '^Energy:' ground_state_static/info ; \s*Total\s*=\s*-0.6697
Match ; 10th state  ; grep '10   --' excited_states_static/eigenvalues ; \s*-0.0177\d*
